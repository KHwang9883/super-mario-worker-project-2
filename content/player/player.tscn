[gd_scene load_steps=28 format=3 uid="uid://dwkukt5v4t3p5"]

[ext_resource type="SpriteFrames" uid="uid://bs88b30blplhb" path="res://content/player/mario_small.tres" id="1_o23i7"]
[ext_resource type="Script" uid="uid://do32t5e0ijewj" path="res://script/level/player/PlayerMediator.cs" id="2_3ac0f"]
[ext_resource type="Script" uid="uid://cwf1kwcspdui2" path="res://script/level/player/PlayerMovement.cs" id="3_i4jjh"]
[ext_resource type="Script" uid="uid://dq38nbqklr26h" path="res://script/level/player/PlayerDieAndHurt.cs" id="4_5unhu"]
[ext_resource type="PackedScene" uid="uid://dfiukm6ibgibj" path="res://content/player/player_dead.tscn" id="5_3ac0f"]
[ext_resource type="Script" uid="uid://bc2odwcafhf0w" path="res://script/level/player/PlayerAnimation.cs" id="6_o23i7"]
[ext_resource type="SpriteFrames" uid="uid://b85b6tckcoib1" path="res://content/player/mario_super.tres" id="7_cvehv"]
[ext_resource type="SpriteFrames" uid="uid://d11sjnlbqehpu" path="res://content/player/mario_fireball.tres" id="8_vx4xa"]
[ext_resource type="SpriteFrames" uid="uid://dg3ftfs0smrbt" path="res://content/player/mario_beetroot.tres" id="9_5unhu"]
[ext_resource type="SpriteFrames" uid="uid://v113q2c6k865" path="res://content/player/mario_lui.tres" id="10_tpspr"]
[ext_resource type="PackedScene" uid="uid://ch220vg7m45nb" path="res://content/player/player_effect.tscn" id="11_q05y8"]
[ext_resource type="Script" uid="uid://bjsu3xt78gy5t" path="res://script/level/player/PlayerSuit.cs" id="11_vx4xa"]
[ext_resource type="Script" uid="uid://bm450h41n7dlb" path="res://script/level/player/PlayerInteraction.cs" id="12_tpspr"]
[ext_resource type="Script" uid="uid://824gdwbiqkl3" path="res://script/level/player/PlayerShoot.cs" id="13_v250f"]
[ext_resource type="PackedScene" uid="uid://ddqu2ik76sdd8" path="res://content/projectile​/player/fireball/player_fireball.tscn" id="14_q05y8"]
[ext_resource type="PackedScene" uid="uid://dt3n2b1ypresm" path="res://content/projectile​/player/beetroot/player_beetroot.tscn" id="16_1esvc"]
[ext_resource type="AudioStream" uid="uid://bya5hq7ingpx1" path="res://content/sound/mario_jump.se.wav" id="16_sks62"]
[ext_resource type="Script" uid="uid://yo6j623q6jsk" path="res://script/level/sound/ContinuousAudioStream2D.cs" id="18_8jrco"]
[ext_resource type="AudioStream" uid="uid://d0g5dfs0iupih" path="res://content/sound/mario_swim.se.wav" id="18_fmriv"]
[ext_resource type="AudioStream" uid="uid://dbe1tmavcr73y" path="res://content/sound/fireball.se.wav" id="19_8jrco"]
[ext_resource type="AudioStream" uid="uid://d21ca0ojgtlmw" path="res://content/sound/stomp.se.wav" id="19_fmriv"]
[ext_resource type="AudioStream" uid="uid://bfhqh4egowku5" path="res://content/sound/powerup.se.wav" id="20_pull8"]
[ext_resource type="AudioStream" uid="uid://bqndr8vnrf8wk" path="res://content/sound/powerdown.se.wav" id="21_1esvc"]

[sub_resource type="ConvexPolygonShape2D" id="ConvexPolygonShape2D_gdtqi"]
points = PackedVector2Array(-12, 0, -12, -14, -2, -24, 2, -24, 12, -14, 12, 0)

[sub_resource type="CircleShape2D" id="CircleShape2D_y66qv"]
radius = 8.0

[sub_resource type="ConvexPolygonShape2D" id="ConvexPolygonShape2D_y66qv"]
points = PackedVector2Array(-12, 0, -12, -38, -2, -48, 2, -48, 12, -38, 12, 0)

[sub_resource type="CircleShape2D" id="CircleShape2D_rmk25"]
radius = 8.0

[node name="Player" type="CharacterBody2D" groups=["player"]]
z_index = 50
collision_layer = 8
collision_mask = 3
slide_on_ceiling = false
floor_block_on_wall = false
platform_on_leave = 2

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(0, 13)
sprite_frames = ExtResource("1_o23i7")
animation = &"idle"
autoplay = "idle"
offset = Vector2(0, -32)

[node name="BlocksPhysicsCollisionSmall" type="CollisionPolygon2D" parent="."]
visible = false
position = Vector2(0, 12)
polygon = PackedVector2Array(-12, 0, -12, -14, -2, -24, 2, -24, 12, -14, 12, 0)

[node name="AreaBodyCollisionSmall" type="ShapeCast2D" parent="."]
position = Vector2(0, 12)
shape = SubResource("ConvexPolygonShape2D_gdtqi")
target_position = Vector2(0, 0)
max_results = 6
collision_mask = 112
collide_with_areas = true

[node name="OutWaterDetectSmall" type="ShapeCast2D" parent="."]
visible = false
position = Vector2(0, -28)
shape = SubResource("CircleShape2D_y66qv")
target_position = Vector2(0, 0)
max_results = 3
collision_mask = 64
collide_with_areas = true

[node name="BlocksPhysicsCollisionSuper" type="CollisionPolygon2D" parent="."]
process_mode = 4
visible = false
position = Vector2(0, 12)
polygon = PackedVector2Array(-12, 0, -12, -38, -2, -48, 2, -48, 12, -38, 12, 0)

[node name="AreaBodyCollisionSuper" type="ShapeCast2D" parent="."]
process_mode = 4
visible = false
position = Vector2(0, 12)
shape = SubResource("ConvexPolygonShape2D_y66qv")
target_position = Vector2(0, 0)
max_results = 6
collision_mask = 112
collide_with_areas = true

[node name="OutWaterDetectSuper" type="ShapeCast2D" parent="."]
process_mode = 4
visible = false
position = Vector2(0, -28)
shape = SubResource("CircleShape2D_rmk25")
target_position = Vector2(0, 0)
max_results = 3
collision_mask = 112
collide_with_areas = true

[node name="PlayerMediator" type="Node" parent="." node_paths=PackedStringArray("player", "playerMovement", "playerDieAndHurt", "playerAnimation", "playerSuit")]
script = ExtResource("2_3ac0f")
player = NodePath("..")
playerMovement = NodePath("PlayerMovement")
playerDieAndHurt = NodePath("PlayerDieAndHurt")
playerAnimation = NodePath("PlayerAnimation")
playerSuit = NodePath("PlayerSuit")

[node name="PlayerMovement" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator", "_player")]
script = ExtResource("3_i4jjh")
_playerMediator = NodePath("..")
_player = NodePath("../..")

[node name="PlayerDieAndHurt" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator", "_player")]
process_mode = 1
script = ExtResource("4_5unhu")
_playerMediator = NodePath("..")
_player = NodePath("../..")
_playerDeadScene = ExtResource("5_3ac0f")

[node name="PlayerAnimation" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator", "_animatedSprite2D", "_player")]
script = ExtResource("6_o23i7")
_playerMediator = NodePath("..")
_animatedSprite2D = NodePath("../../AnimatedSprite2D")
_player = NodePath("../..")
_marioSmall = ExtResource("1_o23i7")
_marioSuper = ExtResource("7_cvehv")
_marioFireball = ExtResource("8_vx4xa")
_marioBeetroot = ExtResource("9_5unhu")
_marioLui = ExtResource("10_tpspr")
_playerEffectScene = ExtResource("11_q05y8")

[node name="PlayerSuit" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator")]
script = ExtResource("11_vx4xa")
_playerMediator = NodePath("..")
Suit = 2
Powerup = 1

[node name="PlayerInteraction" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator", "_player")]
script = ExtResource("12_tpspr")
_playerMediator = NodePath("..")
_player = NodePath("../..")

[node name="PlayerShoot" type="Node" parent="PlayerMediator" node_paths=PackedStringArray("_playerMediator")]
script = ExtResource("13_v250f")
_playerMediator = NodePath("..")
_fireballScene = ExtResource("14_q05y8")
_beetrootScene = ExtResource("16_1esvc")

[node name="PlayerJump" type="AudioStreamPlayer2D" parent="."]
process_mode = 3
stream = ExtResource("16_sks62")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[node name="PlayerSwim" type="AudioStreamPlayer2D" parent="."]
process_mode = 3
stream = ExtResource("18_fmriv")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[node name="PlayerShoot" type="AudioStreamPlayer2D" parent="."]
process_mode = 3
stream = ExtResource("19_8jrco")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[node name="Powerup" type="AudioStreamPlayer2D" parent="."]
process_mode = 3
stream = ExtResource("20_pull8")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[node name="Powerdown" type="AudioStreamPlayer2D" parent="."]
process_mode = 3
stream = ExtResource("21_1esvc")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[node name="PlayerStomp" type="AudioStreamPlayer2D" parent="."]
process_mode = 4
stream = ExtResource("19_fmriv")
script = ExtResource("18_8jrco")
metadata/_custom_type_script = "uid://yo6j623q6jsk"

[connection signal="animation_finished" from="AnimatedSprite2D" to="PlayerMediator/PlayerAnimation" method="OnAnimationFinished"]
[connection signal="JumpStarted" from="PlayerMediator/PlayerMovement" to="PlayerMediator/PlayerAnimation" method="OnJumpStarted"]
[connection signal="JumpStarted" from="PlayerMediator/PlayerMovement" to="PlayerJump" method="play"]
[connection signal="SwimStarted" from="PlayerMediator/PlayerMovement" to="PlayerSwim" method="play"]
[connection signal="PlayerHurted" from="PlayerMediator/PlayerDieAndHurt" to="PlayerMediator/PlayerAnimation" method="OnPlayerHurt"]
[connection signal="PlayerHurted" from="PlayerMediator/PlayerDieAndHurt" to="Powerdown" method="play"]
[connection signal="PlayerInvincibleEnded" from="PlayerMediator/PlayerDieAndHurt" to="PlayerMediator/PlayerAnimation" method="OnPlayerInvincibleEnded"]
[connection signal="PlayerDie" from="PlayerMediator/PlayerInteraction" to="PlayerMediator/PlayerDieAndHurt" method="Die"]
[connection signal="PlayerHurtProcess" from="PlayerMediator/PlayerInteraction" to="PlayerMediator/PlayerDieAndHurt" method="Hurt"]
[connection signal="PlayerPowerPlain" from="PlayerMediator/PlayerInteraction" to="Powerup" method="play"]
[connection signal="PlayerPowerup" from="PlayerMediator/PlayerInteraction" to="PlayerMediator/PlayerAnimation" method="OnPLayerChangingSuit"]
[connection signal="PlayerPowerup" from="PlayerMediator/PlayerInteraction" to="Powerup" method="play"]
[connection signal="PlayerStomp" from="PlayerMediator/PlayerInteraction" to="PlayerMediator/PlayerMovement" method="OnPlayerStomp"]
[connection signal="PlayerShooting" from="PlayerMediator/PlayerShoot" to="PlayerShoot" method="play"]
